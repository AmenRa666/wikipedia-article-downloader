<mediawiki xmlns="http://www.mediawiki.org/xml/export-0.10/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mediawiki.org/xml/export-0.10/ http://www.mediawiki.org/xml/export-0.10.xsd" version="0.10" xml:lang="en">
  <siteinfo>
    <sitename>Wikipedia</sitename>
    <dbname>enwiki</dbname>
    <base>https://en.wikipedia.org/wiki/Main_Page</base>
    <generator>MediaWiki 1.29.0-wmf.3</generator>
    <case>first-letter</case>
    <namespaces>
      <namespace key="-2" case="first-letter">Media</namespace>
      <namespace key="-1" case="first-letter">Special</namespace>
      <namespace key="0" case="first-letter" />
      <namespace key="1" case="first-letter">Talk</namespace>
      <namespace key="2" case="first-letter">User</namespace>
      <namespace key="3" case="first-letter">User talk</namespace>
      <namespace key="4" case="first-letter">Wikipedia</namespace>
      <namespace key="5" case="first-letter">Wikipedia talk</namespace>
      <namespace key="6" case="first-letter">File</namespace>
      <namespace key="7" case="first-letter">File talk</namespace>
      <namespace key="8" case="first-letter">MediaWiki</namespace>
      <namespace key="9" case="first-letter">MediaWiki talk</namespace>
      <namespace key="10" case="first-letter">Template</namespace>
      <namespace key="11" case="first-letter">Template talk</namespace>
      <namespace key="12" case="first-letter">Help</namespace>
      <namespace key="13" case="first-letter">Help talk</namespace>
      <namespace key="14" case="first-letter">Category</namespace>
      <namespace key="15" case="first-letter">Category talk</namespace>
      <namespace key="100" case="first-letter">Portal</namespace>
      <namespace key="101" case="first-letter">Portal talk</namespace>
      <namespace key="108" case="first-letter">Book</namespace>
      <namespace key="109" case="first-letter">Book talk</namespace>
      <namespace key="118" case="first-letter">Draft</namespace>
      <namespace key="119" case="first-letter">Draft talk</namespace>
      <namespace key="446" case="first-letter">Education Program</namespace>
      <namespace key="447" case="first-letter">Education Program talk</namespace>
      <namespace key="710" case="first-letter">TimedText</namespace>
      <namespace key="711" case="first-letter">TimedText talk</namespace>
      <namespace key="828" case="first-letter">Module</namespace>
      <namespace key="829" case="first-letter">Module talk</namespace>
      <namespace key="2300" case="first-letter">Gadget</namespace>
      <namespace key="2301" case="first-letter">Gadget talk</namespace>
      <namespace key="2302" case="case-sensitive">Gadget definition</namespace>
      <namespace key="2303" case="case-sensitive">Gadget definition talk</namespace>
    </namespaces>
  </siteinfo>
  <page>
    <title>Cryptanalysis of the Lorenz cipher</title>
    <ns>0</ns>
    <id>33647361</id>
    <revision>
      <id>746320939</id>
      <parentid>746102702</parentid>
      <timestamp>2016-10-26T17:54:59Z</timestamp>
      <contributor>
        <username>FrescoBot</username>
        <id>9021902</id>
      </contributor>
      <minor/>
      <comment>Bot: [[User:FrescoBot/Links|link syntax]] and minor changes</comment>
      <model>wikitext</model>
      <format>text/x-wiki</format>
      <text xml:space="preserve" bytes="80438">{| class=&quot;wikitable&quot; align=&quot;right&quot; width=300px
|+ Timeline of key events
|-
! Time
! Event
|-
| September 1939
| [[World War II#War breaks out in Europe (1939–40)|War breaks out in Europe]].
|-
| Second half of 1940
| First non-[[Morse code|Morse]] transmissions intercepted.
|-
| June 1941
| First experimental [[Lorenz cipher|SZ40 Tunny]] link started with alphabetic [[Cryptanalysis#Indicator|indicator]].
|-
| August 1941
| Two long messages in [[Cryptanalysis#Depth|depth]] yielded 3700 characters of [[Key (cryptography)|key]].
|-
| January 1942
| Tunny diagnosed from key.&lt;br /&gt; August 1941 traffic read.
|-
| July 1942
| [[Turingery]] method of wheel breaking.&lt;br /&gt; [[Testery]] established&lt;br /&gt; First reading of up-to-date traffic.
|-
| October 1942
| Experimental link closed.&lt;br /&gt; First two of eventual 26 links started with QEP indicator system.,{{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 14 Organisation, 14A Expansion and Growth, (b) Three periods, p. 28}}
|-
| November 1942
| [[#The &quot;1+2 break in&quot;|&quot;1 + 2 break in&quot;]] invented by [[Bill Tutte]].
|-
| February 1943
| More complex SZ42A introduced.
|-
| May 1943
| [[Heath Robinson (codebreaking machine)|Heath Robinson]] delivered.
|-
| July 1943
| [[Newmanry]] founded.
|-
| December 1943
| [[Colossus computer|Colossus I]] working at Dollis Hill prior to delivery to Bletchley Park.{{sfn|Flowers|1983|p=245}}
|-
| February 1944
| First use of Colossus I for a real job.
|-
| June 1944
| [[Invasion of Normandy|Allied invasion of Normandy]].&lt;br /&gt; Colossus II working at Bletchley Park.&lt;br /&gt; SZ42B introduced.
|-
| August 1944
| Cam settings on all Lorenz wheels changed daily.
|-
| May 1945
| [[Victory in Europe Day|Victory in Europe]].&lt;br /&gt; Ten Colossi in use, first sight of a Tunny machine.
|}

'''Cryptanalysis of the [[Lorenz cipher]]''' was the process that enabled the British to read high-level German army messages during [[World War II]]. The British [[Government Communications Headquarters#Government Code and Cypher School (GC&amp;CS)|Government Code and Cypher School (GC&amp;CS)]] at [[Bletchley Park]] decrypted many communications between the ''[[Oberkommando der Wehrmacht]]'' (OKW, German High Command) in Berlin and their army commands throughout occupied Europe, some of which were signed &quot;Adolf Hitler, Führer&quot;.{{sfn|McKay|2010|loc = p. 263 quoting [[Jerry Roberts]]}} These were intercepted non-[[Morse code|Morse]] radio transmissions that had been enciphered by the [[Lorenz cipher|Lorenz SZ]] [[teleprinter]] [[Rotor machine|rotor]] [[stream cipher]] attachments. Decrypts of this traffic became an important source of &quot;[[Ultra]]&quot; intelligence, which contributed significantly to Allied victory.{{sfn|Hinsley|1993|p=8}}

For its high-level secret messages, the German armed services enciphered each [[Character (computing)|character]] using various online ''Geheimschreiber'' (secret writer) stream cipher machines at both ends of a [[Electrical telegraph|telegraph]] link using the [[bit|5-bit]] [[Baudot code#ITA2|International Telegraphy Alphabet No. 2]] (ITA2). These machines were the Lorenz SZ (SZ for ''Schlüssel-Zusatz'', meaning &quot;cipher attachment&quot;) for the army,{{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 11 German Tunny, 11A Fish Machines, (c) The German Ciphered Teleprinter, p. 4}} the [[Siemens and Halske T52]] for the air force and the Siemens T43, which was little used and never broken by the Allies.{{sfn|Weierud|2006|p=307}}

Bletchley Park decrypts of messages enciphered with the [[Enigma machine]]s revealed that the Germans called one of their wireless teleprinter transmission systems ''&quot;Sägefisch&quot;'' (sawfish),{{sfn|Gannon|2007|p=103}} which led British [[cryptographer]]s to refer to encrypted German [[Wireless telegraphy|radiotelegraphic]] traffic as &quot;[[Fish (cryptography)|Fish]]&quot;.{{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 11 German Tunny, 11A Fish Machines, (c) The German Ciphered Teleprinter, p. 4}} &quot;'''Tunny'''&quot; (tunafish) was the name given to the first non-Morse link, and it was subsequently used for the Lorenz SZ machines and the traffic enciphered by them.{{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 11 German Tunny, 11A Fish Machines, (c) The German Ciphered Teleprinter, p. 5}}

As with the entirely separate [[cryptanalysis of the Enigma]], it was German operational shortcomings that allowed the initial diagnosis of the system, and a way into decryption.{{sfn|Copeland|2006|p=45}} Unlike Enigma, no physical machine reached [[Allies of World War II|allied]] hands until the very end of the war in Europe, long after wholesale decryption had been established.{{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 11 German Tunny, 11B The Tunny Cipher Machine, (j) Mechanical Aspects, p. 10}}{{sfn|Good|1993|pp=162,163}} Initially, operator errors produced a number of pairs of transmissions sent with the same [[Key (cryptography)|keys]], giving a [[Cryptanalysis#Depth|&quot;depth&quot;]], which often allowed manual decryption to be achieved. One long depth also allowed the complete logical structure of the machine to be worked out, a quite remarkable cryptanalytical feat on which the subsequent wholesale decrypting of Tunny messages relied.{{sfn|Tutte|1998|pp=5, 6}}

When depths became less frequent, decryption was achieved by a combination of manual and automated methods. The first machine to automate part of the decrypting process was called &quot;[[Heath Robinson (codebreaking machine)|Heath Robinson]]&quot; and it was followed by several other &quot;Robinsons&quot;. These were, however, slow and unreliable, and were supplemented by the much faster and more flexible &quot;[[Colossus computer|Colossus]]&quot;, the world's first electronic, programmable digital computer, ten of which were in use by the end of the war,{{sfn|Flowers|2006|p=81}} by which time some 90% of Tunny messages were being decrypted at Bletchley Park.{{sfn|Roberts|2009}}&lt;ref&gt;All but two of the Colossus computers, which were taken to [[GCHQ]], were destroyed in 1945, and the whole project was kept strictly secret until the 1970s. Thus Colossus did not feature in many early descriptions of the development of electronic computers. {{Harvnb|Gannon|2007|p=431}}&lt;/ref&gt;

Albert W. Small, an American cryptanalyst from the [[Signal Corps (United States Army)|US Signal Corps]] who was seconded to Bletchley Park and worked on Tunny, said in his December 1944 report back to [[Arlington Hall]] that:
{{blockquote|Daily solutions of Fish messages at GC&amp;CS reflect a background of British mathematical genius, superb engineering ability, and solid common sense. Each of these has been a necessary factor. Each could have been overemphasised or underemphasised to the detriment of the solutions; a remarkable fact is that the fusion of the elements has been apparently in perfect proportion. The result is an outstanding contribution to cryptanalytic science.{{sfn|Small|1944|p=1}} }}

==The German Tunny machines==
{{See also|Lorenz cipher}}
[[Image:SZ42-6-wheels-lightened.jpg|right|350px|thumbnail|The Lorenz SZ machines had 12 wheels each with a different number of cams (or &quot;pins&quot;).
{|class=&quot;wikitable&quot; | border=1 | style=&quot;margin: 1em auto 1em auto&quot;
|-
! Wheel number
|1||2||3||4||5||6||7||8||9||10||11||12
|-
! BP wheel name{{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 11 German Tunny, 11B The Tunny Cipher Machine, p. 6}}
| align=&quot;center&quot; | &lt;math&gt;\psi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt;
| align=&quot;center&quot; | &lt;math&gt;\psi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt;
| align=&quot;center&quot; | &lt;math&gt;\psi&lt;/math&gt;&lt;sub&gt;3&lt;/sub&gt;
| align=&quot;center&quot; | &lt;math&gt;\psi&lt;/math&gt;&lt;sub&gt;4&lt;/sub&gt;
| align=&quot;center&quot; | &lt;math&gt;\psi&lt;/math&gt;&lt;sub&gt;5&lt;/sub&gt;
| align=&quot;center&quot; | &lt;math&gt;\mu&lt;/math&gt;37
| align=&quot;center&quot; | &lt;math&gt;\mu&lt;/math&gt;61
| align=&quot;center&quot; | &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt;
| align=&quot;center&quot; | &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt;
| align=&quot;center&quot; | &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;3&lt;/sub&gt;
| align=&quot;center&quot; | &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;4&lt;/sub&gt;
| align=&quot;center&quot; | &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;5&lt;/sub&gt;
|-
! Number of cams (pins)
|43||47||51||53||59||37||61||41||31||29||26||23
|}
]]

The Lorenz SZ cipher attachments implemented a [[Gilbert Vernam#The Vernam cipher|Vernam]] [[stream cipher]], using a complex array of twelve wheels that delivered what should have been a [[Cryptographically secure pseudorandom number generator|cryptographically secure pseudorandom number]] as a [[Key (cryptography)|key]] stream. The key stream was combined with the [[plaintext]] to produce the [[ciphertext]] at the transmitting end using the [[Exclusive or|exclusive or (XOR)]] function.  At the receiving end, an identically configured machine produced the same key stream which was combined with the ciphertext to produce the plaintext, i. e. the system implemented a [[symmetric-key algorithm]].

The right hand five wheels, the [[Chi (letter)|''chi'']] (&lt;math&gt;\chi&lt;/math&gt;) wheels, changed the five impulses (bits) of the incoming character, advancing one position every time. The left hand five, the [[Psi (letter)|''psi'']] (&lt;math&gt;\psi&lt;/math&gt;) wheels, further changed the result of the ''chi'' transform, but they did not always move on with each new character.

The central two [[Mu (letter)|''mu'']] (&lt;math&gt;\mu&lt;/math&gt;) or &quot;motor&quot; wheels determined whether or not the ''psi'' wheels rotated with a new character.{{sfn|Gannon|2007|pp=150, 151}}{{sfn|Good|1993|p=153}} The enhanced SZ42A and SZ42B machines had a more complex arrangement for advancing the ''psi'' wheels than the original SZ40.

Each wheel had a number of cams that could be set in one of two positions. The numbers of cams on the set of wheels were [[Coprime|co-prime]] with each other giving an extremely long period before the key sequence repeated. The process of working out which of the 501 cams were in the raised position was called &quot;wheel breaking&quot; at Bletchley Park.{{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 11 German Tunny, 11E The Tunny Network, (b) Wheel-breaking and Setting, p. 15}}   Deriving the start positions of the wheels for a particular transmission was termed &quot;wheel setting&quot; or simply &quot;setting&quot;. The fact that the ''psi'' wheels all moved together, but not with every input character, was a major weakness of the machines that contributed to cryptanalytical success.

==Secure telegraphy==
{{See also|Electrical telegraph}}
[[Electromechanics|Electro-mechanical]] telegraphy developed in the 1830s and 1840s, well before [[History of the telephone|telephony]], and operated worldwide by the time of the [[World War II|Second World War]]. An extensive system of cables linked sites within and between countries, with a standard voltage of −80&amp;nbsp;V indicating a &quot;mark&quot; and +80&amp;nbsp;V indicating a &quot;space&quot;.{{sfn|Hayward|1993|p=176}} Where cable transmission became impracticable or inconvenient, such as for mobile German Army Units, radio transmission was used.

[[Teleprinter]]s at each end of the circuit consisted of a keyboard and a printing mechanism, and very often a five-hole [[Punched tape|perforated paper-tape]] reading and punching mechanism. When used [[Online and offline|online]], pressing an alphabet key at the transmitting end caused the relevant character to print at the receiving end. Commonly, however, the [[Punched tape#Communications|communication system]] involved the transmitting operator preparing a set of messages offline by punching them onto paper tape, and then going online only for the transmission of the messages recorded on the tape. The system would typically send some ten characters per second, and so occupy the line or the radio channel for a shorter period of time than for online typing.

The characters of the message were represented by the codes of the International Telegraphy Alphabet No. 2 ([[Baudot code#ITA2|ITA2]]). The transmission medium, either wire or radio, used [[asynchronous serial communication]] with each character signaled by a start (space) impulse, 5 data impulses and 1½ stop (mark) impulses. At Bletchley Park mark impulses were signified by '''x''' and space impulses by '''•'''.&lt;ref&gt;In more recent terminology, each impulse would be termed a &quot;[[bit]]&quot; with a mark being binary 1 and a space being binary 0. Punched paper tape had a hole for a mark and no hole for a space.&lt;/ref&gt; For example, the letter &quot;H&quot; would be coded as '''••x•x'''.

{| class=&quot;wikitable&quot; | border=1 | style=&quot;margin: 1em auto 1em auto&quot;
|+ Binary teleprinter code ([[Baudot code#ITA2|ITA2]]) as used at Bletchley Park,{{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 11 German Tunny, 11A Fish Machines, (a) The Teleprinter Alphabet, p. 3}} arranged in [[Gray code|reflection order]] whereby each row differs from its neighbours by only one bit.
|-
! width=&quot;150pt&quot;| Pattern of impulses Mark = '''x''', Space = '''•'''
! width=&quot;100pt&quot;| Binary
! width=&quot;100pt&quot;| Letter shift
! width=&quot;100pt&quot;| Figure shift
! width=&quot;100pt&quot;| BP 'shiftless' interpretation
|-
| align=&quot;center&quot; | '''••.•••''' || align=&quot;center&quot; | 00000 || align=&quot;center&quot; | null || align=&quot;center&quot; | null || align=&quot;center&quot; | /
|-
| align=&quot;center&quot; | '''••.x••''' || align=&quot;center&quot; | 00100 || align=&quot;center&quot; | space || align=&quot;center&quot; | space || align=&quot;center&quot; | 9
|-
| align=&quot;center&quot; | '''••.x•x''' || align=&quot;center&quot; | 00101 || align=&quot;center&quot; | H || align=&quot;center&quot; | # || align=&quot;center&quot; | H
|-
| align=&quot;center&quot; | '''••.••x''' || align=&quot;center&quot; | 00001 || align=&quot;center&quot; | T || align=&quot;center&quot; | 5 || align=&quot;center&quot; | T
|-
| align=&quot;center&quot; | '''••.•xx''' || align=&quot;center&quot; | 00011 || align=&quot;center&quot; | O || align=&quot;center&quot; | 9 || align=&quot;center&quot; | O
|-
| align=&quot;center&quot; | '''••.xxx''' || align=&quot;center&quot; | 00111 || align=&quot;center&quot; | M || align=&quot;center&quot; | . || align=&quot;center&quot; | M
|-
| align=&quot;center&quot; | '''••.xx•''' || align=&quot;center&quot; | 00110 || align=&quot;center&quot; | N || align=&quot;center&quot; |, || align=&quot;center&quot; | N
|-
| align=&quot;center&quot; | '''••.•x•''' || align=&quot;center&quot; | 00010 || align=&quot;center&quot; | CR || align=&quot;center&quot; | CR || align=&quot;center&quot; | 3
|-
| align=&quot;center&quot; | '''•x.•x•''' || align=&quot;center&quot; | 01010 || align=&quot;center&quot; | R || align=&quot;center&quot; | 4 || align=&quot;center&quot; | R
|-
| align=&quot;center&quot; | '''•x.xx•''' || align=&quot;center&quot; | 01110 || align=&quot;center&quot; | C || align=&quot;center&quot; | : || align=&quot;center&quot; | C
|-
| align=&quot;center&quot; | '''•x.xxx''' || align=&quot;center&quot; | 01111 || align=&quot;center&quot; | V || align=&quot;center&quot; | ; || align=&quot;center&quot; | V
|-
| align=&quot;center&quot; | '''•x.•xx''' || align=&quot;center&quot; | 01011 || align=&quot;center&quot; | G || align=&quot;center&quot; | &amp; || align=&quot;center&quot; | G
|-
| align=&quot;center&quot; | '''•x.••x''' || align=&quot;center&quot; | 01001 || align=&quot;center&quot; | L || align=&quot;center&quot; | ) || align=&quot;center&quot; | L
|-
| align=&quot;center&quot; | '''•x.x•x''' || align=&quot;center&quot; | 01101 || align=&quot;center&quot; | P || align=&quot;center&quot; | 0 || align=&quot;center&quot; | P
|-
| align=&quot;center&quot; | '''•x.x••''' || align=&quot;center&quot; | 01100 || align=&quot;center&quot; | I || align=&quot;center&quot; | 8 || align=&quot;center&quot; | I
|-
| align=&quot;center&quot; | '''•x.•••''' || align=&quot;center&quot; | 01000 || align=&quot;center&quot; | LF || align=&quot;center&quot; | LF || align=&quot;center&quot; | 4
|-
| align=&quot;center&quot; | '''xx.•••''' || align=&quot;center&quot; | 11000 || align=&quot;center&quot; | A || align=&quot;center&quot; | - || align=&quot;center&quot; | A
|-
| align=&quot;center&quot; | '''xx.x••''' || align=&quot;center&quot; | 11100 || align=&quot;center&quot; | U || align=&quot;center&quot; | 7 || align=&quot;center&quot; | U
|-
| align=&quot;center&quot; | '''xx.x•x''' || align=&quot;center&quot; | 11101 || align=&quot;center&quot; | Q || align=&quot;center&quot; | 1 || align=&quot;center&quot; | Q
|-
| align=&quot;center&quot; | '''xx.••x''' || align=&quot;center&quot; | 11001 || align=&quot;center&quot; | W || align=&quot;center&quot; | 2 || align=&quot;center&quot; | W
|-
| align=&quot;center&quot; | '''xx.•xx''' || align=&quot;center&quot; | 11011 || align=&quot;center&quot; | FIGS || align=&quot;center&quot; |   || align=&quot;center&quot; | + or 5
|-
| align=&quot;center&quot; | '''xx.xxx''' || align=&quot;center&quot; | 11111 || align=&quot;center&quot; |   || align=&quot;center&quot; | LTRS || align=&quot;center&quot; | - or 8
|-
| align=&quot;center&quot; | '''xx.xx•''' || align=&quot;center&quot; | 11110 || align=&quot;center&quot; | K || align=&quot;center&quot; | ( || align=&quot;center&quot; | K
|-
| align=&quot;center&quot; | '''xx.•x•''' || align=&quot;center&quot; | 11010 || align=&quot;center&quot; | J || align=&quot;center&quot; | Bell || align=&quot;center&quot; | J
|-
| align=&quot;center&quot; | '''x•.•x•''' || align=&quot;center&quot; | 10010 || align=&quot;center&quot; | D || align=&quot;center&quot; | WRU || align=&quot;center&quot; | D
|-
| align=&quot;center&quot; | '''x•.xx•''' || align=&quot;center&quot; | 10110 || align=&quot;center&quot; | F || align=&quot;center&quot; | ! || align=&quot;center&quot; | F
|-
| align=&quot;center&quot; | '''x•.xxx''' || align=&quot;center&quot; | 10111 || align=&quot;center&quot; | X || align=&quot;center&quot; | / || align=&quot;center&quot; | X
|-
| align=&quot;center&quot; | '''x•.•xx''' || align=&quot;center&quot; | 10011 || align=&quot;center&quot; | B || align=&quot;center&quot; | ? || align=&quot;center&quot; | B
|-
| align=&quot;center&quot; | '''x•.••x''' || align=&quot;center&quot; | 10001 || align=&quot;center&quot; | Z || align=&quot;center&quot; | &quot; || align=&quot;center&quot; | Z
|-
| align=&quot;center&quot; | '''x•.x•x''' || align=&quot;center&quot; | 10101 || align=&quot;center&quot; | Y || align=&quot;center&quot; | 6 || align=&quot;center&quot; | Y
|-
| align=&quot;center&quot; | '''x•.x••''' || align=&quot;center&quot; | 10100 || align=&quot;center&quot; | S || align=&quot;center&quot; | ' || align=&quot;center&quot; | S
|-
| align=&quot;center&quot; | '''x•.•••''' || align=&quot;center&quot; | 10000 || align=&quot;center&quot; | E || align=&quot;center&quot; | 3 ||align=&quot;center&quot; | E
|}

The figure shift (FIGS) and letter shift (LETRS) characters determined how the receiving end interpreted the string of characters up to the next shift character. Because of the danger of a shift character being corrupted, some operators would type a pair of shift characters when changing from letters to numbers or ''vice versa''. So they would type 55M88 to represent a full stop.{{sfn|Roberts|2006|p=256}} Such doubling of characters was very helpful for the statistical cryptanalysis used at Bletchley Park. After encipherment, shift characters had no special meaning.

The speed of transmission of a radio-telegraph message was three or four times that of Morse code and a human listener could not interpret it. A standard teleprinter, however would produce the text of the message. The Lorenz cipher attachment changed the [[plaintext]] of the message into [[ciphertext]] that was uninterpretable to those without an identical machine identically set up. This was the challenge faced by the Bletchley Park codebreakers.

==Interception==
{{See also|Wireless telegraphy}}
Intercepting Tunny transmissions presented substantial problems. As the transmitters were directional, most of the signals were quite weak at receivers in Britain. Furthermore, there were some 25 different [[Radio frequency|frequencies]] used for these transmissions, and the frequency would sometimes be changed part way through. After the initial discovery of the non-Morse signals in 1940, a [[Y-stations|Y-station]] was set up on a hill at the Ivy Farm Communications Centre at [[Knockholt]] in Kent, specifically to intercept this traffic.{{sfn|Good|Michie|Timms|1945|loc = 14 Organisation, 14A Expansion and growth, (a) General position p. 28}} The centre was headed by Harold Kenworthy, had 30 [[Receiver (radio)|receiving sets]] and employed some 600 staff. It became fully operational early in 1943.
[[File:Undulator Tape.jpg|right|600px|thumbnail| A length of tape, 12mm (0.5in) wide, produced by an undulator similar to those used during the Second World War for intercepted 'Tunny' wireless telegraphic traffic at Knockholt, for translation into ITA2 characters to be sent to Bletchley Park]]
Because a single missed or corrupted character could make decryption impossible, the greatest accuracy was required.{{sfn|Good|Michie|Timms|1945|loc = 3. Organisation: 33 Knockholt, 33A Ordering tapes, p. 281}} The undulator technology used to record the impulses had originally been developed for high-speed Morse. It produced a visible record of the impulses on narrow paper tape. This was then read by people employed as &quot;slip readers&quot; who interpreted the peaks and troughs as the marks and spaces of ITA2 characters. Perforated paper tape was then produced for telegraphic transmission to Bletchley Park where it was punched out.{{sfn|Gannon|2007|p=333}}

==The Vernam cipher==
{{main|Gilbert Vernam}}
The Vernam cipher implemented by the Lorenz SZ machines utilizes the [[Boolean algebra (logic)|Boolean]] [[Exclusive or|&quot;exclusive or&quot; (XOR)]] function, symbolised by ⊕ and verbalised as &quot;A or B but not both&quot;. This is represented by the following [[truth table]], where '''x''' represents &quot;true&quot; and '''•''' represents &quot;false&quot;.
{| class=&quot;wikitable&quot; || border=1 | style=&quot;margin: 1em auto 1em auto&quot;
|- bgcolor=&quot;#ddeeff&quot; align=&quot;center&quot;
|colspan=2|'''INPUT''' || '''OUTPUT'''
|- bgcolor=&quot;#ddeeff&quot; align=&quot;center&quot;
| A || B || A ⊕ B
|- bgcolor=&quot;#ddffdd&quot; align=&quot;center&quot;
|'''•'''||'''•'''||'''•'''
|- bgcolor=&quot;#ddffdd&quot; align=&quot;center&quot;
|'''•'''||'''x'''||'''x'''
|- bgcolor=&quot;#ddffdd&quot; align=&quot;center&quot;
|'''x'''||'''•'''||'''x'''
|- bgcolor=&quot;#ddffdd&quot; align=&quot;center&quot;
|'''x'''||'''x'''||'''•'''
|}
Other names for this function are: exclusive disjunction, not equal (NEQ), and [[Modular arithmetic|modulo]] 2 addition (without &quot;carry&quot;) and subtraction (without &quot;borrow&quot;). Note that modulo 2 addition and subtraction are identical. Some descriptions of Tunny decryption refer to addition and some to differencing, i.e. subtraction, but they mean the same thing.

[[reciprocal cipher|Reciprocity]] is a desirable feature of a machine cipher so that the same machine with the same settings can be used either for enciphering or for deciphering. The Vernam cipher achieves this, as combining the stream of plaintext characters with the key stream produces the ciphertext, and combining the same key with the ciphertext regenerates the plaintext.{{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 11 German Tunny, 11B The Tunny Cipher Machine, (i) Functional Summary, p. 10}}

Symbolically:

::::&lt;big&gt;[[Plaintext]]  ⊕ [[Key (cryptography)|Key]] = [[Ciphertext]]&lt;/big&gt;

and

::::&lt;big&gt; [[Ciphertext]]  ⊕ [[Key (cryptography)|Key]] = [[Plaintext]] &lt;/big&gt;

Vernam's original idea was to use conventional telegraphy practice, with a paper tape of the plaintext combined with a paper tape of the key at the transmitting end, and an identical key tape combined with the ciphertext signal at the receiving end. Each pair of key tapes would have been unique (a [[One-time pad|one-time tape]]), but generating and distributing such tapes presented considerable practical difficulties. In the 1920s four men in different countries invented rotor Vernam cipher machines to produce a key stream to act instead of a key tape. The Lorenz SZ40/42 was one of these.{{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 11 German Tunny, 11A Fish Machines, (c) The German Ciphered Teleprinter, p. 6}}

==Security features==

[[File:English letter frequency (alphabetic).svg|right|340px|thumbnail|A typical distribution of letters in [[English language]] text. Inadequate encipherment may not sufficiently mask the non-uniform nature of the distribution. This property was exploited in cryptanalysis of the Lorenz cipher by weakening part of the key.]]

A [[monoalphabetic substitution cipher]] such as the [[Caesar cipher]] can easily be broken, given a reasonable amount of ciphertext. This is achieved by [[frequency analysis]] of the different letters of the ciphertext, and comparing the result with the known distribution of letters in the language of the plaintext.{{sfn|Churchhouse|2002|p=24}} With a [[polyalphabetic cipher]], however, there is a different substitution alphabet for each successive character. So a frequency analysis shows an approximately [[Uniform distribution (discrete)|uniform distribution]], such as that obtained from a [[Cryptographically secure pseudorandom number generator|(pseudo) random number generator]]. By trying multiple putative ''chi''-component partial key streams against the ciphertext, the Bletchley Park cryptanalysts were able to detect some of the underlying non-uniformity and so identify which partial key stream was likely to be correct.

The total number of cams on the twelve wheels of the SZ machines was 501. Each cam could either be in a raised position, in which case it contributed '''x''' to the logic of the system, or in the lowered position, in which case it generated '''•'''.{{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 11 German Tunny, 11B The Tunny Cipher Machine, (j) Mechanical Aspects, p. 10}}  The total possible number of patterns of raised cams was 2&lt;sup&gt;501&lt;/sup&gt; which is an astronomically large number.{{sfn|Churchhouse|2002|pp=158, 159}} In practice, however, about half of the cams on each wheel were in the raised position. Later, the Germans realized that if the number of raised cams was not very close to half there would be runs of '''x'''s and '''•'''s, a cryptographic weakness.{{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 11 German Tunny, 11C Wheel patterns,  pp. 11, 12}}&lt;ref&gt;This statement is an over-simplification. The real constraint is more complex, that ab=½. For further details see: {{Harvnb|Good|Michie|Timms|1945|p=17}} in 1 Introduction: 12 Cryptographic Aspects, 12A The Problem, (d) Early methods and {{Harvnb|Good|Michie|Timms|1945|p=306}} in 42 Early Hand Methods: 42B Machine breaking for March 1942, (e) Value of a and b.&lt;/ref&gt; Indeed, this weakness was one of the two factors that led to the system being diagnosed.

The pattern of raised and lowered cams was changed daily on the motor wheels (&lt;math&gt;\mu&lt;/math&gt;37 and &lt;math&gt;\mu&lt;/math&gt;61). The ''chi'' wheel cam patterns were initially changed monthly. The ''psi'' wheel patterns were changed quarterly until October 1942 when the frequency was increased to monthly, and then to daily on 1 August 1944, when the frequency of changing the ''chi'' wheel patterns was also changed to daily.{{sfn|Copeland|2006|p=48}}

The number of start positions of the wheels was 43×47×51×53×59×37×61×41×31×29×26×23 which is approximately 1.6×10&lt;sup&gt;19&lt;/sup&gt; (16 billion billion), far too large a number for cryptanalysts to try an exhaustive &quot;[[brute-force attack]]&quot;. As the numbers of positions of the wheels are [[Coprime|co-prime]] with each other this number is also the period before the key repeated. Sometimes the Lorenz operators disobeyed instructions and two messages were transmitted with the same start positions, a phenomenon termed a [[Cryptanalysis#Depth|&quot;depth&quot;]]. The method by which the transmitting operator told the receiving operator the wheel settings that he had chosen for the message which he was about to transmit was termed the [[Cryptanalysis#Indicator|&quot;indicator&quot;]] at Bletchley Park.

In August 1942, the stereotyped starts to the messages, which were useful to cryptanalysts, were replaced by some irrelevant text, which made identifying the true message somewhat harder. This new material was dubbed ''quatsch'' (German for &quot;nonsense&quot;) at Bletchley Park.{{sfn|Edgerley|2006|pp=273, 274}}

During the phase of the experimental transmissions, the indicator consisted of twelve German forenames, the initial letters of which indicated the position to which the operators turned the twelve wheels. As well as showing when two transmissions were fully in depth, it also allowed the identification of partial depths where two indicators differed only in one or two wheel positions. From October 1942 the indicator system changed to the sending operator transmitting the unenciphered letters QEP&lt;ref&gt;Initially QSN (see {{Harvnb|Good|Michie|Timms|1945|p=320}} in 44 Early Hand statistical Methods: 44A Introduction of the QEP (QSN) System).&lt;/ref&gt; followed by a two digit number. This number was taken serially from a code book that had been issued to both operators and gave, for each QEP number, the settings of the twelve wheels. The books were replaced when they had been used up, but between replacements, complete depths could be identified by the re-use of a QEP number on a particular Tunny link.{{sfn|Copeland|2006|pp=44–47}}

==Diagnosis==
{| class=&quot;wikitable&quot; | border=1 | align=&quot;right&quot; | style=&quot;margin: 1em auto 1em auto&quot;
|+ Notation{{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 12 Cryptographic Aspects, 12A The Problem, (a) Formulae and Notation, p. 16}} &lt;br /&gt; Letters can represent character streams, individual 5-bit characters or, if subscripted, individual bits of characters
|-
| &lt;big&gt;P&lt;/big&gt; || plaintext
|-
| &lt;big&gt;K&lt;/big&gt; || key – the sequence of characters [[XOR]]'ed (added)&lt;br /&gt; to the plaintext to give the ciphertext
|-
| &lt;big&gt;&lt;math&gt;\chi&lt;/math&gt;&lt;/big&gt; ||''chi'' component of key
|-
| &lt;big&gt;&lt;math&gt;\psi&lt;/math&gt;&lt;/big&gt; ||''psi'' component of key
|-
| &lt;big&gt;&lt;math&gt;\psi'&lt;/math&gt;&lt;/big&gt; ||extended ''psi'' – the actual sequence of characters&lt;br /&gt; added by the ''psi'' wheels, including those&lt;br /&gt; when they do not advance{{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 11 German Tunny, 11B The Tunny Cipher Machine, (e) Psi-key, p. 7}}
|-
| &lt;big&gt;Z&lt;/big&gt; || ciphertext
|-
| &lt;big&gt;D&lt;/big&gt; || de-''chi'' — the ciphertext with the ''chi''&lt;br /&gt; component of the key removed
|-
| &lt;big&gt;Δ&lt;/big&gt; || any of the above XOR'ed with&lt;br /&gt; its successor character or bit{{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 11 German Tunny, 11C Wheel Patterns, (b) Differenced and Undifferenced Wheels, p. 11}}
|-
| &lt;big&gt;⊕&lt;/big&gt; || the XOR operation
|-
|}
The first step in breaking a new cipher is to diagnose the logic of the processes of encryption and decryption. In the case of a machine cipher such as Tunny, this entailed establishing the logical structure and hence functioning of the machine. This was achieved without the benefit of seeing a machine—which only happened in 1945, shortly before the allied victory in Europe.&lt;ref&gt;{{Citation | last = Sale | first = Tony | author-link = Anthony Sale | title = The Lorenz Cipher and how Bletchley Park broke it | url = http://www.codesandciphers.org.uk/lorenz/fish.htm | accessdate = 21 October 2010 }}&lt;/ref&gt; The enciphering system was very good at ensuring that the ciphertext &lt;big&gt;Z&lt;/big&gt; contained no statistical, periodic or linguistic characteristics to distinguish it from random. However this did not apply to {{nowrap|&lt;big&gt;K&lt;/big&gt;, &lt;big&gt;&lt;math&gt;\chi&lt;/math&gt;&lt;/big&gt;, &lt;big&gt;&lt;math&gt;\psi'&lt;/math&gt;&lt;/big&gt; and &lt;big&gt;D&lt;/big&gt;,}} which was the weakness that meant that Tunny could be broken.{{sfn|Good|Michie|Timms|1945|loc = 12 Cryptographic Aspects: 12A The Problem, (c) Weaknesses of Tunny, p. 16}}

During the experimental period of Tunny transmissions when the twelve-letter indicator system was in use, [[John Tiltman]], Bletchley Park's veteran and remarkably gifted cryptanalyst, studied the Tunny ciphertexts and identified that they used a Vernam cipher.

When two transmissions ('''a''' and '''b''') use the same key, i.e. they are in depth, combining them eliminates the effect of the key.{{sfn|Tutte|2006|p=353}} Let us call the two ciphertexts &lt;big&gt;Za&lt;/big&gt; and &lt;big&gt;Zb&lt;/big&gt;, the key &lt;big&gt;K&lt;/big&gt; and the two plaintexts &lt;big&gt;Pa&lt;/big&gt; and &lt;big&gt;Pb&lt;/big&gt;. We then have:
::::&lt;big&gt; Za  ⊕  Zb = Pa  ⊕  Pb &lt;/big&gt;
If the two plaintexts can be worked out, the key can be recovered from either ciphertext-plaintext pair e.g.:
::::&lt;big&gt; Za  ⊕  Pa = K &lt;/big&gt;or &lt;br /&gt;&lt;big&gt; Zb  ⊕  Pb = K &lt;/big&gt;

On 31 August 1941, two long messages were received that had the same indicator HQIBPEXEZMUG. The first seven characters of these two ciphertexts were the same, but the second message was shorter. The first 15 characters of the two messages were as follows:
{| class=&quot;wikitable&quot; | border=1 | style=&quot;margin: 1em auto 1em auto&quot;
| align=&quot;center&quot; | &lt;big&gt; Za&lt;/big&gt; || '''&lt;tt&gt;JSH5N ZYZY5 GLFRG&lt;/tt&gt;'''
|-
| align=&quot;center&quot; | &lt;big&gt;Zb&lt;/big&gt; || '''&lt;tt&gt;JSH5N ZYMFS /885I&lt;/tt&gt;'''
|-
| align=&quot;center&quot; | &lt;big&gt; Za  ⊕  Zb&lt;/big&gt; || '''&lt;tt&gt;///// //FOU GFL4M&lt;/tt&gt;'''
|}
John Tiltman tried various likely pieces of plaintext, i.e. a [[Known-plaintext attack|&quot;cribs&quot;]], against the &lt;big&gt;Za  ⊕  Zb&lt;/big&gt; string and found that the first plaintext message started with the German word ''SPRUCHNUMMER'' (message number). In the second plaintext, the operator had used the common abbreviation ''NR'' for ''NUMMER''. There were more abbreviations in the second message, and the punctuation sometimes differed. This allowed Tiltman to work out, over ten days, the plaintext of both messages, as a sequence of plaintext characters discovered in &lt;big&gt;Pa&lt;/big&gt;, could then be tried against &lt;big&gt;Pb&lt;/big&gt; and ''vice versa''.{{sfn|Copeland|2010}} In turn, this yielded almost 4000 characters of key.{{sfn|Tutte|1998|p=4}}

Members of the Research Section worked on this key to try to derive a mathematical description of the key generating process, but without success. [[Bill Tutte]] joined the section in October 1941 and was given the task. He had read chemistry and mathematics at [[Trinity College, Cambridge]] before being recruited to Bletchley Park. At his training course, he had been taught the [[Kasiski examination]] technique of writing out a key on squared paper with a new row after a defined number of characters that was suspected of being the frequency of repetition of the key. If this number was correct, the columns of the matrix would show more repetitions of sequences of characters than chance alone.

Tutte thought that it was possible that, rather than using this technique on the whole letters of the key, which were likely to have a long frequency of repetition, it might be worth trying it on only one impulse on the grounds that &quot;''the part might be cryptographically simpler than the whole''&quot;.{{sfn|Tutte|2006|p=356}} Given that the Tunny indicators used 25 letters (excluding J) for 11 of the positions, but only 23 letters for the twelfth, he tried Kasiski's technique on the first impulse (bit) of the key characters using a repetition of 25 × 23 = 575. This did not produce a large number of repetitions in the columns, but Tutte did observe the phenomenon on a diagonal. He therefore tried again with 574, which showed up repeats in the columns. Recognising that the [[prime factor]]s of this number are 2, 7 and 41, he tried again with a period of 41 and &quot;''got a rectangle of dots and crosses that was replete with repetitions''&quot;.{{sfn|Tutte|2006|p=357}}

It was clear, however, that the first impulse of the key was more complicated than that produced by a single wheel of 41 positions. Tutte called this component of the key &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt; (''chi''). He figured that there was another component, which was XOR-ed with this, that did not always change with each new character, and that this was the product of a wheel that he called &lt;math&gt;\psi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt; (''psi''). The same applied for each of the five impulses—indicated here by subscripts. So for a single character, the key '''K''' consisted of two components:
:::: &lt;big&gt;K&lt;/big&gt; = &lt;big&gt;&lt;math&gt;\chi&lt;/math&gt;  ⊕  &lt;math&gt;\psi&lt;/math&gt; &lt;/big&gt;.
The actual sequence of characters added by the ''psi'' wheels, including those when they do not advance, was referred to at the ''extended psi'',{{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 11 German Tunny, 11B The Tunny Cipher Machine, (e) Psi-key, p. 7}} and symbolised by &lt;math&gt;\psi&lt;/math&gt;&lt;span style=&quot;font-size:125%;&quot;&gt;'&lt;/span&gt;
::::&lt;big&gt;K&lt;/big&gt; = &lt;big&gt;&lt;math&gt;\chi&lt;/math&gt;  ⊕  &lt;math&gt;\psi&lt;/math&gt;&lt;span style=&quot;font-size:125%;&quot;&gt;'&lt;/span&gt; &lt;/big&gt;.

Tutte's derivation of the &lt;math&gt;\psi&lt;/math&gt; component was made possible by the fact that dots were more likely than not to be followed by dots, and crosses more likely than not to be followed by crosses. This was a product of a weakness in the German key setting, which they later stopped. Once Tutte had made this breakthrough, the rest of the Research Section joined in to study the other impulses, and it was established that the five &lt;math&gt;\psi&lt;/math&gt; wheels all moved together under the control of two &lt;math&gt;\mu&lt;/math&gt; (''mu'' or &quot;motor&quot;) wheels.

Diagnosing the functioning of the Tunny machine in this way was a truly remarkable cryptanalytical achievement, and was described when Tutte was inducted as Officer of the Order of Canada in October 2001, as &quot;''one of the greatest intellectual feats of World War II''&quot;.&lt;ref&gt;{{Citation | last = O'Connor | first = J J | last2 = Robertson | first2 = E F | author2-link = Edmund F. Robertson | title = MacTutor Biography: William Thomas Tutte | publisher = University of St Andrews | year = 2003 | url = http://www-history.mcs.st-and.ac.uk/Biographies/Tutte.html | accessdate = 28 April 2013 }}&lt;/ref&gt;

==Turingery==
{{see also|Turingery}}
In July 1942 [[Alan Turing]] spent a few weeks in the Research Section.{{sfn|Tutte|2006|pp=359, 360}} He had become interested in the problem of breaking Tunny from the keys that had been obtained from depths.{{sfn|Copeland|2006|p=380}} In July, he developed a method of deriving the cam settings (&quot;wheel breaking&quot;) from a length of key. It became known as &quot;Turingery&quot;{{sfn|Good|Michie|Timms|1945|loc = 4 Early Methods and History: 43 Testery Methods 1942-1944, 43B Turingery, p. 313}} (playfully dubbed &quot;Turingismus&quot; by Peter Ericsson, [[Peter Hilton]] and [[Donald Michie]]{{sfn|Copeland|2006|p=380}} and introduced the important method of &quot;differencing&quot; on which much of the rest of breaking Tunny messages in the absence of depths, was based.{{sfn|Good|Michie|Timms|1945|loc = 4 Early Methods and History: 43 Testery Methods 1942-1944, 43B Turingery, p. 313}}

===Differencing===
The search was on for a process that would manipulate the ciphertext or key to produce a frequency distribution of characters that departed from the uniformity that the enciphering process aimed to achieve. Turing worked out that the XOR combination of the values of successive characters in a stream of ciphertext or key, emphasised any departures from a uniform distribution.{{sfn|Good|Michie|Timms|1945|loc = 4 Early Methods and History: 43 Testery Methods 1942-1944, 43B Turingery, p. 313}} The resultant stream was called the difference (symbolised by the Greek letter &quot;delta&quot; '''Δ'''){{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 11 German Tunny, 11C Wheel patterns, (b) Differenced and Undifferenced Wheels p. 11}} because XOR is the same as modulo 2 subtraction. So, for a stream of characters '''S''', the difference '''ΔS''' was obtained as follows, where &lt;u&gt;underline&lt;/u&gt; indicates the succeeding character:

::::&lt;big&gt; ΔS = S ⊕ &lt;u&gt;S&lt;/u&gt; &lt;/big&gt;

The stream '''S''' may be ciphertext '''Z''', plaintext '''P''', key '''K''' or either of its two components &lt;math&gt;\chi&lt;/math&gt; and &lt;math&gt;\psi&lt;/math&gt;. The relationship amongst these elements still applies when they are differenced. For example, as well as:

::::&lt;big&gt; K = &lt;math&gt;\chi&lt;/math&gt; ⊕ &lt;math&gt;\psi&lt;/math&gt; &lt;/big&gt;

It is the case that:
::::&lt;big&gt; ΔK = Δ&lt;math&gt;\chi&lt;/math&gt; ⊕ Δ&lt;math&gt;\psi&lt;/math&gt; &lt;/big&gt;

Similarly for the ciphertext, plaintext and key components:

::::&lt;big&gt; ΔZ =  ΔP ⊕ Δ&lt;math&gt;\chi&lt;/math&gt; ⊕ Δ&lt;math&gt;\psi&lt;/math&gt; &lt;/big&gt;

So:
::::&lt;big&gt; ΔP = ΔZ ⊕ Δ&lt;math&gt;\chi&lt;/math&gt; ⊕ Δ&lt;math&gt;\psi&lt;/math&gt; &lt;/big&gt;

The reason that differencing provided a way into Tunny, was that although the frequency distribution of characters in the ciphertext could not be distinguished from a random stream, the same was not true for a version of the ciphertext from which the ''chi'' element of the key had been removed. This is because, where the plaintext contained a repeated character and the ''psi'' wheels did not move on, the differenced ''psi'' character ('''Δ'''&lt;math&gt;\psi&lt;/math&gt;) would be the null character ('&lt;span style=&quot;font-size:140%;&quot;&gt;'''/'''&lt;/span&gt;' at Bletchley Park).  When XOR-ed with any character, this character has no effect, so in these circumstances, '''ΔK''' = '''Δ'''&lt;math&gt;\chi&lt;/math&gt;. The ciphertext modified by the removal of the ''chi'' component of the key was called the de-''chi'' '''D''' at Bletchley Park,&lt;ref&gt;{{Harvnb|Small|1944|p=2}} refers to the de-''chi'' as being &quot;pseudo plain&quot;&lt;/ref&gt; and the process of removing it as &quot;de-''chi''-ing&quot;. Similarly for the removal of the ''psi'' component which was known as &quot;de-''psi''-ing&quot; (or &quot;deep sighing&quot; when it was particularly difficult).{{sfn|Tutte|2006|p=365}}

So the delta de-''chi'' '''ΔD''' was:
::::&lt;big&gt; ΔD = ΔZ ⊕ Δ&lt;math&gt;\chi&lt;/math&gt; &lt;/big&gt;

Repeated characters in the plaintext were more frequent both because of the characteristics of German (EE, TT, LL and SS are relatively common),&lt;ref&gt;{{Citation | last = Singh | first = Simon | author-link = Simon Singh | title = The Black Chamber | url = http://www.simonsingh.net/The_Black_Chamber/hintsandtips.html | accessdate = 28 April 2012 }}&lt;/ref&gt; and because telegraphists frequently repeated the figures-shift and letters-shift characters&lt;ref&gt;[[Max Newman|Newman]] c. 1944 p. 387&lt;/ref&gt; as their loss in an ordinary telegraph transmission could lead to gibberish.{{sfn|Carter|2008|p = 14}}

To quote the General Report on Tunny:&lt;blockquote&gt;Turingery introduced the principle that the key differenced at one, now called '''ΔΚ''', could yield information unobtainable from ordinary key. This '''Δ''' principle was to be the fundamental basis of nearly all statistical methods of wheel-breaking and setting.{{sfn|Good|Michie|Timms|1945|loc = 4 Early Methods and History: 43 Testery Methods 1942-1944, 43B Turingery, p. 313}}&lt;/blockquote&gt;

Differencing was applied to each of the impulses of the ITA2 coded characters.&lt;ref&gt;The five impulses or bits of the coded characters are sometimes referred to as five levels.&lt;/ref&gt; So, for the first impulse, that was enciphered by wheels &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt; and &lt;math&gt;\psi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt;, differenced at one:
::::&lt;big&gt; ΔK&lt;sub&gt;1&lt;/sub&gt; = K&lt;sub&gt;1&lt;/sub&gt; ⊕ &lt;u&gt;K&lt;/u&gt;&lt;sub&gt;1&lt;/sub&gt; &lt;/big&gt;
And for the second impulse:
::::&lt;big&gt; ΔK&lt;sub&gt;2&lt;/sub&gt; = K&lt;sub&gt;2&lt;/sub&gt; ⊕ &lt;u&gt;K&lt;/u&gt;&lt;sub&gt;2&lt;/sub&gt; &lt;/big&gt;
And so on.

It is also worth noting that the periodicity of the ''chi'' and ''psi'' wheels for each impulse (41 and 43 respectively for the first impulse) is reflected in its pattern of '''ΔK'''. However, given that the ''psi'' wheels did not advance for every input character, as did the ''chi'' wheels, it was not simply a repetition of the pattern every 41 × 43 = 1763 characters for '''ΔK&lt;sub&gt;1&lt;/sub&gt;''', but a more complex sequence.

===Turing's method===
{{See also|Turingery}}
Turing's method of deriving the cam settings of the wheels from a length of key obtained from a depth, involved an [[Iteration|iterative]] process. Given that the delta ''psi'' character was the null character '&lt;span style=&quot;font-size:140%;&quot;&gt;'''/'''&lt;/span&gt;' half of the time on average, an assumption that '''ΔK'''&amp;nbsp;=&amp;nbsp;'''Δ'''&lt;math&gt;\chi&lt;/math&gt; had a 50% chance of being correct. The process started by treating a particular '''ΔK''' character as being the '''Δ'''&lt;math&gt;\chi&lt;/math&gt; for that position. The resulting putative bit pattern of &lt;big&gt; '''x''' &lt;/big&gt; and &lt;big&gt; '''•''' &lt;/big&gt; for each ''chi'' wheel, was recorded on a sheet of paper that contained as many columns as there were characters in the key, and five rows representing the five impulses of the '''Δ'''&lt;math&gt;\chi&lt;/math&gt;. Given the knowledge from Tutte's work, of the periodicity of each of the wheels, this allowed the propagation of these values at the appropriate positions in the rest of the key.

A set of five sheets, one for each of the ''chi'' wheels, was also prepared. These contained a set of columns corresponding in number to the cams for the appropriate ''chi'' wheel, and were referred to as a 'cage'. So the &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;3&lt;/sub&gt; cage had 29 such columns.&lt;ref&gt;{{Harvnb|Copeland|2006|p=385}} which reproduces a &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;3&lt;/sub&gt; cage from the General Report on Tunny&lt;/ref&gt; Successive 'guesses' of '''Δ'''&lt;math&gt;\chi&lt;/math&gt; values then produced further putative cam state values. These might either agree or disagree with previous assumptions, and a count of agreements and disagreements was made on these sheets. Where disagreements substantially outweighed agreements, the assumption was made that the '''Δ'''&lt;math&gt;\psi&lt;/math&gt; character was not the null character '&lt;span style=&quot;font-size:140%;&quot;&gt;'''/'''&lt;/span&gt;', so the relevant assumption was discounted. Progressively, all the cam settings of the ''chi'' wheels were deduced, and from them, the ''psi'' and motor wheel cam settings.

As experience of the method developed, improvements were made that allowed it to be used with much shorter lengths of key than the original 500 or so characters.&quot;{{sfn|Good|Michie|Timms|1945|loc = 4 Early Methods and History: 43 Testery Methods 1942-1944, 43B Turingery, p. 313}}

==Testery==
{{See also|Testery}}
The Testery was the section at Bletchley Park that performed the bulk of the work involved in decrypting Tunny messages.{{sfn|Roberts|2009|loc = 34 minutes in}} By July 1942, the volume of traffic was building up considerably. A new section was therefore set up, led by [[Ralph Tester]]—hence the name. The staff consisted mainly of ex-members of the Research Section,{{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 14 Organisation, 14A Expansion and Growth, (b) Three periods, p. 28}} and included Peter Ericsson, [[Peter Hilton]], Denis Oswald and [[Jerry Roberts]].{{sfn|Roberts|2006|p=250}} The Testery's methods were almost entirely manual, both before and after the introduction of automated methods in the [[Newmanry]] to supplement and speed up their work.{{sfn|Roberts|2009}}{{sfn|Good|Michie|Timms|1945|loc = 1 Introduction: 14 Organisation, 14A Expansion and Growth, (b) Three periods, p. 28}}

The first phase of the work of the Testery ran from July to October, with the predominant method of decryption being based on depths and partial depths.&lt;ref&gt;Unlike a full depth, when all twelve letters of the indicator were the same, a partial depth occurred when one or two of the indicator letters differed.&lt;/ref&gt; After ten days, however, the stereotyped opening of the messages was replaced by nonsensical ''quatsch'' making decryption more difficult. This period was a productive time, albeit each decryption took considerable time until, in September, a depth was received that allowed Turing's method of wheel breaking &quot;[[#Turingery|Turingery]]&quot; to be used, and current traffic started to be read. Extensive data about the statistical characteristics of the language of the messages was compiled, and the collection of cribs extended.&quot;{{sfn|Good|Michie|Timms|1945|loc = 4 Early Methods and History: 43 Testery Methods 1942-1944, 43B Turingery, p. 313}}

In late October 1942 the original, experimental Tunny link was closed and two new links (Codfish and Octopus) were opened. With these and subsequent links, the 12-letter indicator system of specifying the message key was replaced by the QEP system. This meant that only full depths could be recognised—from identical QEP numbers—which led to a considerable reduction in traffic decrypted.

Once the Newmanry became operational in June 1943, the nature of the work performed in the Testery changed, with decrypts, and wheel breaking no longer relying on depths.

===British Tunny===
[[File:British Tunny Rebuild.jpg|right|thumbnail|280px|A rebuilt British Tunny at [[the National Museum of Computing]], [[Bletchley Park]]. It emulated the functions of the Lorenz SZ40/42, producing printed cleartext from ciphertext input.]]

The so-called &quot;British Tunny Machine&quot; was a device that exactly replicated the functions of the SZ40/42 machines. It was used to produce the German cleartext from a ciphertext tape, after the cam settings had been determined.{{sfn|Hayward|1993|pp=175–192}} The functional design was produced at Bletchley Park where ten Testery Tunnies were in use by the end of the war. It was designed and built in [[Tommy Flowers|Tommy Flowers']] laboratory at the [[Post Office Research Station|General Post Office Research Station]] at Dollis Hill by Gil Hayward, [[Allen Coombs|&quot;Doc&quot; Coombs]], Bill Chandler and Sid Broadhurst.{{sfn|Hayward|2006|p=291}} It was mainly built from standard British telephone exchange [[electro-mechanical]] equipment such as [[relay]]s and [[Stepping switch|uniselectors]]. Input and output was by means of a teleprinter with paper tape reading and punching.{{sfn|Currie|2006|pp=265–266}} These machines were used in both the [[#Testery|Testery]] and later the [[#Newmanry|Newmanry]]. Dorothy Du Boisson who was a machine operator and a member of the [[Women's Royal Naval Service]] (Wren), described plugging up the settings as being like operating an old fashioned telephone exchange and that she received electric shocks in the process.{{sfn|Copeland|2006|loc = p. 162 quoting Dorothy Du Boisson}}

When Flowers was invited by Hayward to try the first British Tunny machine at Dollis Hill by typing in the standard test phrase: &quot;Now is the time for all good men to come to the aid of the party&quot;, he much appreciated that the rotor functions had been set up to provide the following [[William Wordsworth|Wordsworthian]] output:{{sfn|Hayward|2006|p=292}}

{| class=&quot;wikitable&quot; | border=1 | style=&quot;margin: 1em auto 1em auto&quot;
| align=&quot;center&quot; | &lt;small&gt;Input&lt;/small&gt; || '''&lt;tt&gt;NOW IS THE TIME FOR ALL GOOD MEN TO COME TO THE AID OF THE PARTY&lt;/tt&gt;'''
|-
| align=&quot;center&quot; | &lt;small&gt;Output&lt;/small&gt; || '''&lt;tt&gt;I WANDERED LONELY AS A CLOUD THAT FLOATS ON HIGH OER VALES AND H&lt;/tt&gt;'''
|}

Additional features were added to the British Tunnies to simplify their operation. Further refinements were made for the versions used in the Newmanry, the third Tunny being equipped to produce de-''chi'' tapes.{{sfn|Good|Michie|Timms|1945|loc = 51 Introductory: 56. Copying Machines, 56K The (Newmanry) Tunny Machine, pp. 376-378}}{{sfn|Small|1944|p=105}}

==Newmanry==
The [[Newmanry]] was a section set up under [[Max Newman]] in December 1942 to look into the possibility of assisting the work of the Testery by automating parts of the processes of decrypting Tunny messages. Newman had been working with Gerry Morgan, head of the Research Section on ways of breaking Tunny when Bill Tutte approached them in November 1942 with the idea of what became known as the &quot;1+2 break in&quot;.{{sfn|Good|Michie|Timms|1945|loc = 15 SomeHistorical Notes: 15A. First Stages in Machine Development, p. 33}} This was recognised as being feasible, but only if automated.

Newman produced a functional specification of what was to become the &quot;[[#Robinsons|Heath Robinson]]&quot; machine.{{sfn|Good|Michie|Timms|1945|loc = 15 SomeHistorical Notes: 15A. First Stages in Machine Development, p. 33}} He recruited the [[Post Office Research Station]] at Dollis Hill, and [[C. E. Wynn-Williams|Dr C.E. Wynn-Williams]] at the [[Telecommunications Research Establishment]] (TRE) at Malvern to implement his idea. Work on the engineering design started in January 1943 and the first machine was delivered in June. The staff at that time consisted of Newman, [[Donald Michie]], [[I. J. Good|Jack Good]], two engineers and 16 Wrens. By the end of the war the Newmanry contained three Robinson machines, ten Colossus Computers and a number of British Tunnies. The staff were 26 cryptographers, 28 engineers and 275 Wrens.{{sfn|Good|Michie|Timms|1945|loc = 31 Mr Newnam's Section: 31A, Growth, p. 276}}

The automation of these processes required the processing of large quantities of punched paper tape such as those on which the enciphered messages were received. Absolute accuracy of these tapes and their transcription was essential, as a single character in error could invalidate or corrupt a huge amount of work. Jack Good introduced the maxim &quot;If it's not checked it's wrong&quot;.{{sfn|Good|2006|p=215}}

===The &quot;1+2 break in&quot;===
The essence of [[W. T. Tutte]]'s &quot;1+2 break in&quot; method was to find the initial settings of the ''chi'' component of the key by exhaustively trying all positions of its combination with the ciphertext, and looking for evidence of the non-uniformity that reflected the characteristics of the original plaintext.{{sfn|Good|Michie|Timms|1945|loc = 44 Hand Statistical Methods: Setting - Statistical pp. 321–322}} {{sfn|Budiansky|2006|pp=58–59}} The wheel breaking process had to have successfully produced the current cam settings to allow the relevant sequence of characters of the ''chi'' wheels to be generated. It was totally impracticable to generate the 22 million characters from all five of the ''chi'' wheels, so it was initially limited to 41 × 31 = 1271 from the first two.

Given that for each of the five impulses ''i'':
::::&lt;big&gt;Z&lt;sub&gt;i&lt;/sub&gt; = &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;i&lt;/sub&gt; ⊕ &lt;math&gt;\psi&lt;/math&gt;&lt;sub&gt;i&lt;/sub&gt; ⊕ P&lt;sub&gt;i&lt;/sub&gt;&lt;/big&gt;
and hence
::::&lt;big&gt;P&lt;sub&gt;i&lt;/sub&gt; = Z&lt;sub&gt;i&lt;/sub&gt; ⊕ &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;i&lt;/sub&gt; ⊕ &lt;math&gt;\psi&lt;/math&gt;&lt;sub&gt;i&lt;/sub&gt;&lt;/big&gt;
for the first two impulses:
::::&lt;big&gt;(P&lt;sub&gt;1&lt;/sub&gt; ⊕ P&lt;sub&gt;2&lt;/sub&gt;) = (Z&lt;sub&gt;1&lt;/sub&gt; ⊕ Z&lt;sub&gt;2&lt;/sub&gt;) ⊕ (&lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt; ⊕ &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt;) ⊕ (&lt;math&gt;\psi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt; ⊕ &lt;math&gt;\psi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt;)&lt;/big&gt;
Calculating a putative &lt;big&gt;P&lt;sub&gt;1&lt;/sub&gt; ⊕ P&lt;sub&gt;2&lt;/sub&gt;&lt;/big&gt; in this way for each starting point of the &lt;big&gt;&lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt; ⊕ &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt;&lt;/big&gt; sequence would yield '''x'''s and '''•'''s with, in the long run, a greater proportion of '''•'''s when the correct starting point had been used. Tutte knew, however, that using the [[#Differencing|differenced]] (∆) values amplified this effect&lt;ref&gt;For this reason Tutte's 1 + 2 method is sometimes called the &quot;double delta&quot; method.&lt;/ref&gt; because any repeated characters in the plaintext would always generate '''•''', and similarly ∆&lt;math&gt;\psi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt; ⊕ ∆&lt;math&gt;\psi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt; would generate '''•''' whenever the ''psi'' wheels did not move on, and about half of the time when they did - some 70% overall.

Tutte analyzed a decrypted ciphertext with the differenced version of the above function:
::::&lt;big&gt;(∆Z&lt;sub&gt;1&lt;/sub&gt; ⊕ ∆Z&lt;sub&gt;2&lt;/sub&gt;) ⊕ (∆&lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt; ⊕ ∆&lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt;) ⊕ (∆&lt;math&gt;\psi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt; ⊕ ∆&lt;math&gt;\psi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt;)&lt;/big&gt;
and found that it generated '''•''' some 55% of the time.{{sfn|Tutte|2006|p=364}}  Given the nature of the contribution of the ''psi'' wheels, the alignment of ''chi''-stream with the ciphertext that gave the highest count of '''•'''s from &lt;big&gt;(∆Z&lt;sub&gt;1&lt;/sub&gt; ⊕ ∆Z&lt;sub&gt;2&lt;/sub&gt; ⊕ ∆&lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt; ⊕ ∆&lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt;)&lt;/big&gt; was the one that was most likely to be correct.{{sfn|Carter|2008|pp=16-17}} This technique could be applied to any pair of impulses and so provided the basis of an automated approach to obtaining the de-''chi'' (D) of a ciphertext, from which the ''psi'' component could be removed by manual methods.

===Robinsons===
{{Main|Heath Robinson (codebreaking machine)}}
[[Heath Robinson (codebreaking machine)|Heath Robinson]] was the first machine produced to automate Tutte's 1+2 method. It was given the name by the [[Women's Royal Naval Service|Wrens]] who operated it, after cartoonist [[William Heath Robinson]], who drew immensely complicated mechanical devices for simple tasks, similar to the American cartoonist [[Rube Goldberg]].

The functional specification of the machine was produced by Max Newman. The main engineering design was the work of Frank Morrell&lt;ref&gt;{{Citation | title = Bletchley Park National Code Centre: November 1943 | url = http://www.bletchleypark.org.uk/content/archive/nov1943.rhtm | accessdate = 21 November 2012 }}&lt;/ref&gt; at the [[Post Office Research Station]] at Dollis Hill in North London, with his colleague Tommy Flowers designing the &quot;Combining Unit&quot;. Dr [[C. E. Wynn-Williams]] from the [[Telecommunications Research Establishment]] at Malvern produced the high-speed electronic valve and relay counters.{{sfn|Good|Michie|Timms|1945|loc = 15 Some Historical Notes: 15A. First Stages in Machine Development, (c) Heath Robinson p. 33}}  Construction started in January 1943,{{sfn|Copeland|2006|p=65}} the prototype machine was in use at Bletchley Park in June.{{sfn|Good|Michie|Timms|1945|loc = 37 Machine Setting Organisation: (b) Robinsons and Colossi p. 290}}

The main parts of the machine were:
* a tape transport and reading mechanism (dubbed the &quot;bedstead&quot; because of its resemblance to an upended metal bed frame) that ran the looped key and message tapes at between 1000 and 2000 characters per second;
* a combining unit that implemented the logic of Tutte's method;
* a counting unit that counted the number of '''•'''s, and if it exceeded a pre-set total, displayed or printed it.

The prototype machine was effective despite a number of serious shortcomings. Most of these were progressively overcome in the development of what became known as &quot;Old Robinson&quot;.{{sfn|Good|Michie|Timms|1945|loc = 52 Development of Robinson and Colossus: (b) Heath Robinson p. 328}}

===Colossus===
{{Main|Colossus computer}}
[[File:Colossus.jpg|right|thumbnail|320px|A Mark 2 Colossus computer. The Wren operators are (left to right) Dorothy Du Boisson and Elsie Booker. The slanted control panel on the left was used to set the pin patterns on the Lorenz. The &quot;bedstead&quot; paper tape transport is on the right.]]
[[Image:ColossusRebuild 11.jpg|right|thumbnail|320px|In 1994, a team led by [[Anthony Sale|Tony Sale]] (right) began a reconstruction of a Mark 2 Colossus at Bletchley Park. Here, in 2006, Sale and Phil Hayes supervise the breaking of an enciphered message with the completed machine.]]

Tommy Flowers' experience with Heath Robinson, and his previous, unique experience of [[Vacuum tube|thermionic valves (vacuum tubes)]] led him to realize that a better machine could be produced using electronics. Instead of the key stream being read from a punched paper tape, an electronically generated key stream could allow much faster and more flexible processing. Flowers' suggestion that this could be achieved with a machine that was entirely electronic and would contain between one and two thousand valves, was treated with incredulity at both the Telecommunications Research Establishment and at Bletchley Park, as it was thought that it would be &quot;too unreliable to do useful work&quot;. He did, however, have the support of the Controller of Research at Dollis Hill, W Gordon Radley,{{sfn|Fensom|2006|pp=300–301}} and he implemented these ideas producing [[Colossus computer|Colossus]], the world's first electronic, digital, computing machine that was at all programmable, in the remarkably short time of ten months.{{sfn|Flowers|2006|p=80}} In this he was assisted by his colleagues at the [[Post Office Research Station]] [[Dollis Hill]]: Sidney Broadhurst, William Chandler, [[Allen Coombs]] and Harry Fensom.

The prototype Mark 1 Colossus (Colossus I), with its 1500 valves, became operational at Dollis Hill in December 1943{{sfn|Flowers|1983|p=245}} and was in use at Bletchley Park by February 1944. This processed the message at 5000 characters per second using the impulse from reading the tape's sprocket holes to act as the [[clock signal]]. It quickly became evident that this was a huge leap forward in cryptanalysis of Tunny. Further Colossus machines were ordered and the orders for more Robinsons cancelled. An improved Mark 2 Colossus (Colossus II) contained 2400 valves and first worked at Bletchley Park on 1 June 1944, just in time for the [[Normandy Landings|D-day Normandy landings]].

The main parts of this machine were:{{sfn|Flowers|1983|pp=245-252}}
* a tape transport and reading mechanism (the &quot;bedstead&quot;) that ran the message tape in a loop at 5000 characters per second;
* a unit that generated the key stream electronically;
* five parallel processing units that could be programmed to perform a large range of Boolean operations;
* five counting units that each counted the number of '''•'''s or '''x'''s, and if it exceeded a pre-set total, printed it out.

The five parallel processing units allowed Tutte's &quot;1+2 break in&quot; and other functions to be run at an effective speed of 25,000 characters per second by the use of circuitry invented by Flowers that would now be called a [[shift register]]. Donald Michie worked out a method of using Colossus to assist in wheel breaking as well as for wheel setting.{{sfn|Good|Michie|1992}} This was then implemented in special hardware on later Colossi.

A total of ten Colossus computers were in use and an eleventh was being commissioned at the end of the war in Europe ([[Victory in Europe Day|VE-Day]]).{{sfn|Flowers|1983|p=247}}

==Special machines==
As well as the commercially produced teleprinters and re-perforators, a number of other machines were built to assist in the preparation and checking of tapes in the Newmanry and Testery.{{sfn|Good|Michie|Timms|1945|loc = 13 Machines: 13A Explanation of the Categories, (b) Copying Machines p. 25 and 13C Copying Machines p. 27}}{{sfn|Good|Michie|Timms|1945|loc = 56 Copying Machines pp. 367–379}} The approximate complement as at May 1945 was as follows.
{| class=&quot;wikitable&quot; | border=1 | style=&quot;margin: 1em auto 1em auto&quot;
|+ Machines used in deciphering Tunny as at May 1945
|-
! width=&quot;100pt&quot; | Name
! width=&quot;450pt&quot;| Function
! Testery
! Newmanry
|-
| Super Robinson|| Used for crib runs in which two tapes were compared in all positions. Contained some valves. || || align=&quot;center&quot; |  2
|-
| Colossus Mk.2 || Counted a condition involving a message tape and an electronically generated key character stream imitating the various Tunny wheels in different relative positions (&quot;stepping&quot;).{{sfn|Good|Michie|Timms|1945|loc = 53 Colossus: 53A Introduction, p. 333}} Contained some 2,400 valves. || || align=&quot;center&quot; |  10
|-
| Dragons || Used for setting short [[Known-plaintext attack|cribs]] by &quot;crib-dragging&quot; (hence the name).{{sfn|Hayward|2006|pp=291–292}}{{sfn|Michie|2006|p=236}} || || align=&quot;center&quot; | 2
|-
| Aquarius || A machine under development at the war's end for the &quot;go-backs&quot; of the SZ42B, which stored the contents of the message tape in a large bank of [[capacitor]]s that acted as an electronic memory.{{sfn|Fensom|2006|pp=301–302}}  ||   || align=&quot;center&quot; | 1
|-
| Proteus || A machine for utilising [[Cryptanalysis#Depth|depths]] that was under construction at the war's end but was not completed. ||   ||
|-
| Decoding Machines || Translated from cipertext typed in, to plaintext printed out. Some of the later ones were speeded up with the use of a few valves.&lt;ref&gt;{{Harvnb|Good|Michie|Timms|1945|pp=326}} in 51 Introductory: (e) Electronic counters etc.&lt;/ref&gt; A number of modified machines were produced for the Newmanry || align=&quot;center&quot; |   || align=&quot;center&quot; | 13
|-
| Tunnies || See [[#British Tunny|British Tunny]] above || align=&quot;center&quot; | 3 || align=&quot;center&quot; | 
|-
| Miles || A set of increasingly complex machines (A, B, C, D) that read two tapes and combined them in a variety of ways to produce an output tape. || align=&quot;center&quot; | 3 ||
|-
| Garbo || Similar to Junior, but with a [[#Differencing|Delta'ing]] facility. || align=&quot;center&quot; | 3 ||
|-
| Juniors || For printing tapes ''via'' a plug panel to change characters as necessary. || align=&quot;center&quot; | 4  ||
|-
| Insert machines || Similar to Angel, but with a device for making corrections by hand. || align=&quot;center&quot; | 2 ||
|-
| Angels || Copied tapes. || align=&quot;center&quot; | 4 ||
|-
| Hand perforators || Generated tape from a keyboard. || align=&quot;center&quot; | 2 ||
|-
| Hand counters || Measured text length. || align=&quot;center&quot; | 6 ||
|-
| Stickers (hot) || [[Bostik]] and [[Petroleum ether|benzene]] was used for sticking tapes to make a loop. The tape to be stuck was inserted between two electrically heated plates and the benzene evaporated. || align=&quot;center&quot; | 3 ||
|-
| Stickers (cold) || Stuck tapes without heating. || align=&quot;center&quot; | 6 ||
|}

==Steps in wheel setting==
Working out the start position of the ''chi'' (&lt;math&gt;\chi&lt;/math&gt;) wheels required first that their cam settings had been determined by &quot;wheel breaking&quot;. Initially, this was achieved by two messages having been sent in [[Cryptanalysis#Depth|depth]].

The number of start positions for the first two wheels, &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt; and &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt; was 41×31 = 1271. The first step was to try all of these start positions against the message tape. This was [[Cryptanalysis of the Lorenz cipher#Tutte's &quot;1+2 break in&quot;|Tutte's &quot;1+2 break in&quot;]] which involved computing &lt;big&gt;(∆Z&lt;sub&gt;1&lt;/sub&gt; ⊕ ∆Z&lt;sub&gt;2&lt;/sub&gt; ⊕ ∆&lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt; ⊕ ∆&lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt;)&lt;/big&gt;—which gives a putative (&lt;big&gt;∆D&lt;sub&gt;1&lt;/sub&gt; ⊕ ∆D&lt;sub&gt;2&lt;/sub&gt;&lt;/big&gt;)—and counting the number of times this gave '''•'''. Incorrect starting positions would, on average, give a dot count of 50% of the message length. On average, the dot count for a correct starting point would be 54%, but there was inevitably a considerable spread of values around these averages.{{sfn|Carter|2008|pp=16-17}}

Both Heath Robinson, which was developed into what became known as &quot;Old Robinson&quot;, and Colossus were designed to automate this process. Statistical theory allowed the derivation of measures of how far any count was from the 50% expected with an incorrect starting point for the ''chi'' wheels. This measure of deviation from randomness was called sigma. Starting points that gave a count of less than 2.5 × sigma, named the &quot;set total&quot;, were not printed out.{{sfn|Small|1944|p=9}} The ideal for a run to set &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt; and &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt; was that a single pair of trial values produced one outstanding value for sigma thus identifying the start positions of the first two ''chi'' wheels. An example of the output from such a run on a Mark 2 Colossus with its five counters: a, b, c, d and e, is given below.
{| class=&quot;wikitable&quot; | border=1 | style=&quot;margin: 1em auto 1em auto&quot;
|+ Output table abridged from Small's &quot;The Special Fish Report&quot;.{{sfn|Small|1944|p=19}} The set total threshold was 4912.
|-
! &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt;
! &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt;
! Counter
! Count
! Operator's notes on the output
|-
| 06 || 11 || align=&quot;center&quot; |  a || 4921 ||
|-
| 06 || 13 || align=&quot;center&quot; |  a || 4948 ||
|-
| 02 || 16 || align=&quot;center&quot; |  e || 4977 ||
|-
| 05 || 18 || align=&quot;center&quot; |  b || 4926 ||
|-
| 02 || 20 || align=&quot;center&quot; |  e || 4954 ||
|-
| 05 || 22 || align=&quot;center&quot; |  b || 4914 ||
|-
| 03 || 25 || align=&quot;center&quot; |  d || 4925 ||
|-
| 02 || 26 || align=&quot;center&quot; |  e || 5015 || ← 4.6 sigma
|-
| 19 || 26 || align=&quot;center&quot; |  c || 4928 ||
|-
| 25 || 19 || align=&quot;center&quot; |  b || 4930 ||
|-
| 25 || 21 || align=&quot;center&quot; |  b || 5038 || ← 5.1 sigma
|-
| 29 || 18 || align=&quot;center&quot; |  c || 4946 ||
|-
| 36 || 13 || align=&quot;center&quot; |  a || 4955 ||
|-
| 35 || 18 || align=&quot;center&quot; |  b || 4926 ||
|-
| 36 || 21 || align=&quot;center&quot; |  a || 5384 || ← 12.2 sigma ch &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt; &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt;  ! !
|-
| 36 || 25 || align=&quot;center&quot; |  a || 4965 ||
|-
| 36 || 29 || align=&quot;center&quot; |  a || 5013 ||
|-
| 38 || 08 || align=&quot;center&quot; |  d || 4933 ||
|-
|}

Because of the parallelism in the Mark 2 Colossus, such a run did not require the message tape to run through the reader 41 × 31 = 1271 times, but one fifth of this i.e. 255 times. With an average-sized message, this would take about eight minutes.{{sfn|Small|1944|p=8}} Having identified possible &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt;, &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt; start positions, the next step was to try to find the start positions for the other ''chi'' wheels. In the example given above, there is a single setting of &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt;  = 36 and &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt; = 21 whose sigma value makes it stand out from the rest. This was not always the case, and Small enumerates 36 different further runs that might be tried according to the result of the &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt;, &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt; run.{{sfn|Small|1944|p=7}} At first the choices in this iterative process were made by the cryptanalyst sitting at the typewriter output, and calling out instructions to the Wren operators. Max Newman devised a decision tree and then set Jack Good and Donald Michie the task of devising others.{{sfn|Good|Michie|Timms|1945|loc = 23 Machine Setting: 23B The Choice of Runs, pp. 79,80}} These were used by the Wrens without recourse to the cryptanalysts if certain criteria were met.{{sfn|Good|2006|p=218}}

In the above one of Small's examples, the next run was with the first two ''chi'' wheels set to the start positions found and three separate parallel explorations of the remaining three ''chi'' wheels. Such a run was called a &quot;short run&quot; and took about two minutes.{{sfn|Small|1944|p=8}}

{| class=&quot;wikitable&quot; | border=1 | style=&quot;margin: 1em auto 1em auto&quot;
|+ Output table adapted from Small's &quot;The Special Fish Report&quot;.{{sfn|Small|1944|p=20}} The set total threshold was 2728.
|-
! &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt;
! &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt;
! &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;3&lt;/sub&gt;
! &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;4&lt;/sub&gt;
! &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;5&lt;/sub&gt;
! Counter
! Count
! Operator's notes on the output
|-
| 36 || 21 || 01 || || || align=&quot;center&quot; |  a || 2938 || ← 6.8 rho  !  &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;3&lt;/sub&gt;  !
|-
| 36 || 21 || || 01 || || align=&quot;center&quot; |  b || 2763 ||
|-
| 36 || 21 || || || 01 || align=&quot;center&quot; |  c || 2803 ||
|-
| 36 || 21 || || 02 || || align=&quot;center&quot; |  b || 2733 ||
|-
| 36 || 21 || || || 04 || align=&quot;center&quot; |  c || 3003 || ← 8.6 rho  ! &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;5&lt;/sub&gt;  !
|-
| 36 || 21 || 06 || || || align=&quot;center&quot; |  a || 2740 ||
|-
| 36 || 21 || || || 07 || align=&quot;center&quot; |  c || 2750 ||
|-
| 36 || 21 || || 09 || || align=&quot;center&quot; |  b || 2811 ||
|-
| 36 || 21 || 11 || || || align=&quot;center&quot; |  a || 2751 ||
|-
| 36 || 21 || || || 12 || align=&quot;center&quot; |  c || 2759 ||
|-
| 36 || 21 || || || 14 || align=&quot;center&quot; |  c || 2733 ||
|-
| 36 || 21 || 16 || || || align=&quot;center&quot; |  a || 2743 ||
|-
| 36 || 21 || || 19 || || align=&quot;center&quot; |  b || 3093 || ← 11.1 rho  ! &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;4&lt;/sub&gt;  !
|-
| 36 || 21 || 20 || || || align=&quot;center&quot; |  a || 2785 ||
|-
| 36 || 21 || || 22 || || align=&quot;center&quot; |  b || 2823 ||
|-
| 36 || 21 || 24 || || || align=&quot;center&quot; |  a || 2740 ||
|-
| 36 || 21 || || 25 || || align=&quot;center&quot; |  b || 2796 ||
|-
| 36 || 21 || || 01 || || align=&quot;center&quot; |  b || 2763 ||
|-
| 36 || 21 || || || 07 || align=&quot;center&quot; |  c || 2750 ||
|-
|}

So the probable start positions for the ''chi'' wheels are: &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;1&lt;/sub&gt; = 36, &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;2&lt;/sub&gt; = 21, &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;3&lt;/sub&gt; = 01, &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;4&lt;/sub&gt; = 19, &lt;math&gt;\chi&lt;/math&gt;&lt;sub&gt;5&lt;/sub&gt; = 04. These had to be verified before the de-''chi'' ('''D''') message was passed to the Testery. This involved Colossus performing a count of the frequency of the 32 characters in '''ΔD'''. Small describes the check of the frequency count of the '''ΔD''' characters as being the &quot;acid test&quot;,{{sfn|Small|1944|p=15}} and that practically every cryptanalyst and Wren in the Newmanry and Testery knew the contents of the following table by heart.

{| class=&quot;wikitable&quot; | border=1 | style=&quot;margin: 1em auto 1em auto&quot;
|+ Relative frequency count of characters in ΔD.&lt;ref&gt;Adapted from {{Harvnb|Small|1944|p=5}}&lt;/ref&gt;
|-
! Char.
! Count
! width=&quot;25pt&quot;|
! Char.
! Count
! width=&quot;25pt&quot;|
! Char.
! Count
! width=&quot;25pt&quot;|
! Char.
! Count
|-
| / || 1.28 |||| R || 0.92 |||| A || 0.96 |||| D || 0.89
|-
| 9 || 1.10 |||| C || 0.90 |||| U || 1.24 |||| F || 1.00
|-
| H || 1.02 |||| V || 0.94 |||| Q || 1.01 |||| X || 0.87
|-
| T || 0.99 |||| G || 1.00 |||| W || 0.89 |||| B || 0.82
|-
| O || 1.04 |||| L || 0.92 |||| 5 || 1.43 |||| Z || 0.89
|-
| M || 1.00 |||| P || 0.96 |||| 8 || 1.12 |||| Y || 0.97
|-
| N || 1.00 |||| I || 0.96 |||| K || 0.89 |||| S || 1.04
|-
| 3 || 1.13 |||| 4 || 0.90 |||| J || 1.03 |||| E || 0.89
|}

If the derived start points of the ''chi'' wheels passed this test, the de-''chi''-ed message was passed to the Testery where manual methods were used to derive the ''psi'' and motor settings. As Small remarked, the work in the Newmanry took a great amount of statistical science, whereas that in the Testery took much knowledge of language and was of great interest as an art. Cryptanalyst Jerry Roberts made the point that this Testery work was a greater load on staff than the automated processes in the Newmanry.{{sfn|Roberts|2009}}

==See also==
* [[The National Museum of Computing]]

==References and Notes==
{{reflist|3}}

==Bibliography==
{{Refbegin}}
* {{Citation | last = BBC Timewatch | title = Code Breakers: Bletchley Park's lost Heroes | year = 2011 | url = http://www.youtube.com/watch?v=JF48sl15OCg | format = video }}
* {{Citation | last = Budiansky | first = Stephen | author-link = Stephen Budiansky | title = Colossus, Codebreaking, and the Digital Age | year = 2006 }} in {{Harvnb|Copeland|2006|pp=52–63}}
* {{Citation | last = Carter | first = Frank | title = Codebreaking with the Colossus Computer | publisher = Bletchley Park Trust | series = Bletchley Park Reports | volume = 1 | year = 2008 | edition = New | isbn = 978-1-906723-00-2 }}
* {{Citation | last = Churchhouse | first = Robert | title = Codes and Ciphers: Julius Caesar, the Enigma and the Internet | place = Cambridge | publisher = Cambridge University Press | year = 2002 | isbn = 978-0-521-00890-7 }}
* {{Citation | editor-last = Copeland | editor-first = B. Jack | editor-link = Jack Copeland | title = Colossus: The Secrets of Bletchley Park's Codebreaking Computers | place = Oxford | publisher = Oxford University Press | year = 2006 | isbn = 978-0-19-284055-4 }}
* {{Citation | last = Copeland | first = B. Jack | author-link = Jack Copeland | title = Colossus: Breaking the German ‘Tunny’ Code at Bletchley Park. An Illustrated History | journal = The Rutherford Journal | volume = 3 | year = 2010 }}
* {{Citation | last = Currie| year=2006|first = Helen| title = An ATS girl in the Testery }} in {{Harvnb|Copeland|2006|pp=264–268}}
* {{Citation | last = Edgerley | first = Peter | title = The Testery and the Breaking of Fish | year = 2006 }} in {{Harvnb|Copeland|2006|pp=269–277}}
* {{Citation | editor-last = Erskine | editor-first = Ralph | editor2-last = Smith | editor2-first = Michael | editor2-link = Michael Smith (newspaper reporter) | title = The Bletchley Park Codebreakers | publisher = Biteback Publishing Ltd | origyear = 2001 | year = 2011 | isbn = 978-1-84954-078-0}} Updated and extended version of ''Action This Day: From Breaking of the Enigma Code to the Birth of the Modern Computer'' Bantam Press 2001
* {{Citation | last = Fensom | first = Harry | title = How Colossus was built and Operated | year = 2006 }} in {{Harvnb|Copeland|2006|pp=297–304}}
* {{Citation | last = Flowers |first= Thomas H. | authorlink = Tommy Flowers |url=http://www.ivorcatt.com/47c.htm | title =The Design of Colossus |journal=Annals of the History of Computing |volume=5 |issue=3 |year= 1983|pages=239–252 |doi=10.1109/MAHC.1983.10079}}
* {{Citation | last = Flowers | first = Thomas H. | author-link = Tommy Flowers | title = D-Day at Bletchley ''and'' Colossus | year = 2006 }} in {{Harvnb|Copeland|2006|pp=78–83, 91–100}}
* {{Citation | last = Gannon | first = Paul  | title = Colossus: Bletchley Park's Greatest Secret | year = 2007 | origyear = 2006 | publisher = Atlantic Books | isbn = 978-1-84354-331-2 }}
* {{Citation | last = Good | first = Jack | author-link = I. J. Good | last2 = Michie | first2 = Donald | author2-link = Donald Michie | last3 = Timms | first3 = Geoffrey | title = General Report on Tunny: With Emphasis on Statistical Methods | year = 1945 | id = UK Public Record Office HW 25/4 and HW 25/5 | url = http://www.alanturing.net/turing_archive/archive/index/tunnyreportindex.html | accessdate = 15 September 2010 }} That version is a facsimile copy, but there is a transcript of much of this document in '.pdf' format at: {{Citation | last = Sale | first = Tony | author-link = Anthony Sale | title = Part of the &quot;General Report on Tunny&quot;, the Newmanry History, formatted by Tony Sale| year = 2001 | url = http://www.codesandciphers.org.uk/documents/newman/newman.pdf | accessdate = 20 September 2010 }}, and a web transcript of Part 1 at: {{Citation | last = Ellsbury | first = Graham | title = General Report on Tunny With Emphasis on Statistical Methods | url = http://www.ellsbury.com/tunny/tunny-001.htm | accessdate = 3 November 2010 }}
* {{Citation | last = Good | first = Jack | author-link = I. J. Good | last2 = Michie | first2 = Donald | author2-link = Donald Michie | title = I J Good and Donald Michie in conversation with David Kahn and Karen Frrankel | publisher = Computer History Museum | publication-date = 22 June 2012 | year = 1992 | url = http://www.youtube.com/watch?feature=endscreen&amp;NR=1&amp;v=6p3mhkNgRXs | accessdate = 19 April 2013 }}
* {{Citation | last = Good | first = Jack | author-link = I. J. Good | title = Enigma and Fish | year = 1993 }} in {{Harvnb|Hinsley|Stripp|1993|pp=149–166 }}
* {{Citation | last = Good | first = Jack | author-link = I. J. Good | title = From Hut 8 to the Newmanry | year = 2006 }} in {{Harvnb|Copeland|2006|pp=204–222}}
* {{Citation | last = Government Code and Cypher School | author-link = Government Code and Cypher School | title = The Bletchley Park 1944 Cryptographic Dictionary formatted by Tony Sale | year = 1944 | url = http://www.codesandciphers.org.uk/documents/cryptdict/cryptxp3.pdf | accessdate = 7 October 2010 }}
* {{Citation | last = Hayward | first = Gil | title = Operation Tunny | year = 1993 }} in {{Harvnb|Hinsley|Stripp|1993|pp = 175–192}}
* {{Citation | last = Hayward | first = Gil | title = The British Tunny Machine | year = 2006 }} in {{Harvnb|Copeland|2006|pp=291–296}}
* {{Citation | editor-last = Hinsley | editor-first = F.H. | editor-link = Harry Hinsley | editor2-last = Stripp | editor2-first = Alan | year = 1993 | origyear = 1992 | title = Codebreakers: The inside story of Bletchley Park | publication-place = Oxford | publisher = Oxford University Press | isbn = 978-0-19-280132-6 }}
* {{Citation  | last = Hinsley | first = F.H. | author-link = Harry Hinsley | year = 1993 | title = Introduction: The influence of Ultra in the Second World War }} in {{Harvnb|Hinsley|Stripp|1993|pp=1–13}}
* {{Citation | last = McKay | first = Sinclair | title = The Secret Life of Bletchley Park: The WWII Codebreaking Centre and the men and women who worked there | place = London | publisher = Aurum Press | year = 2010 | isbn = 978 1 84513 539 3 }}
* {{Citation | last = Michie | first = Donald | author-link = Donald Michie | title = Codebreaking and Colossus | year = 2006 }} in {{Harvnb|Copeland|2006|pp=223–246}}
* {{Citation | last = Newman | first = Max | author-link = Max Newman | year = c. 1944 | title = Appendix 7: Delta-chi Method }} in {{Harvnb|Copeland|2006|pp=386–390}}
* {{Citation | last = Roberts | first = Jerry | author-link = Jerry Roberts | contribution = Major Tester's Section | title = Colossus: The Secrets of Bletchley Park's Codebreaking Computers | year = 2006 }} in {{Harvnb|Copeland|2006|pp=249–259}}
* {{Citation | last = Roberts | first = Jerry | author-link = Jerry Roberts | year = 2009 | title = My Top-Secret Codebreaking During World War II: The Last British Survivor of Bletchley Park’s Testery | url = http://www.ucl.ac.uk/news/news-articles/0903/09031601 | type = video | publisher = University College London | format = iTunes U }}
* {{Citation | last = Small | first = Albert W. | title = The Special Fish Report | location = The American National Archive (NARA) College Campus Washington | date = December 1944  | url = http://www.codesandciphers.org.uk/documents/small/smallix.htm | accessdate = 7 March 2013}}
* {{Citation | last = Tutte | first = William T. | authorlink = W. T. Tutte | year = 2006 | title = Appendix 4: My Work at Bletchley Park }} in {{Harvnb|Copeland|2006|pp=352–369}}
* {{Citation | last = Tutte | first = W. T. | author-link = W. T. Tutte | title = Fish and I | date = 19 June 1998 | url = http://www.usna.edu/Users/math/wdj/_files/documents/papers/cryptoday/tutte_fish.pdf | accessdate = 7 April 2012 }} Transcript of a lecture given by Prof. Tutte at the [[University of Waterloo]]
* {{Citation | last = Weierud | first = Frode | title = Bletchley Park's Sturgeon—The Fish That Laid No Eggs | year = 2006}} in {{Harvnb|Copeland|2006|pp=307–327}}
* {{Citation | last = Wylie | first = Shaun | author-link = Shaun Wylie | title = Breaking Tunny and the birth of Colossus | year = 2001 }} in {{Harvnb|Erskine|Smith|2011|pp=283–304}}
{{Refend}}

[[Category:Articles created via the Article Wizard]]
[[Category:History of cryptography]]
[[Category:Signals intelligence of World War II]]
[[Category:Bletchley Park]]</text>
      <sha1>b4cq9tf58w8k4ih7pzx6xakhyfprx01</sha1>
    </revision>
  </page>
</mediawiki>
